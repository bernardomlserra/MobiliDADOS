#CÁLCULO DO PNT

Para calcular a quantidade de pessoas próximas a estações de média e alta capacidade (PNT) é necessário rodar dois códigos.
No primeiro você prepara os shapesfiles dos setores censitários fornecidos pelo IBGE e utiliza-os no segundo codigo junto aos shapefiles das estações transporte de média e alta capacidade (TMA), criando o buffer e realizando o cálculo daquela cidade ou Região Metropolitana (RM). Nos códigos desta pasta apresentamos um exemplo de cálculo da Região Metropolitana de Salvador (RMS).

Cada codigo esta dividido em passos de 1 a 5, explicados em notas ao lado das linhas.
Aqui você encontra o que cada passo permite fazer:

###Codigo #1: 1_Preparacao_shapes_dados_Exemplo_RMS.R

1. Instalar e abrir todos os pacotes necessários. 
   O comando setwd() permite definir um diretório para salvar os seus arquivos

2. Criar o shapefile dos municípios da região metropolitana
2.1 Aqui os shapefiles dos setores censitarios e dos muncípios do estado são importados e descompactados do site do IBGE.
2.2 Nesta parte é realizado o recorte dos muncicípios e dos setores censitarios a partir do código único de cada municipio (CD_GEOCMU). Neste caso os CD_GEOCMU da linha municipios_rms e setores_rms se referem aos 13 municípios da Regiao Metropolitana de Salvador (RMS).

3. Preparar shapefile da região metropolitana com dados
3.1 Importar as tabelas do censo, descompactar o arquivo e abrir no R.
    ATENCAO: É necessário que as tabelas estejam no formato .xlsx para que os pacotes instalados no passo 1. consigam ler. 
    Neste codigo abrimos as tabelas basico, pessoa03, pessoa05, ResponsavelRenda e DomicilioRenda para termos dados sobre quantidade de pessoas geral, quantidade de pessoas com renda entre 0 e 1/2 Salario Minimo, 1/2 e 1 SM, 1 e 3 SM, 3 e mais SM, quantidade de mulheres negras e quantidade de mulheres negras responsaveis pela renda familiar que recebem até 2 SM.
    Novamente o comando str() serve para verificar a estrutura das tabelas
3.2 Selecionar os dados necessarios em cada tabela (populacao, mulheres, mulheres com renda ate 2 SM responsaveis por domicilioe  os dados de renda).

4. Unir os dados das tabelas criadas no passo 3 com os shapefiles dos setores censitarios

5. Realizar o calculo total de cada variavel para a RM (ou cidade) selecionada no passo 2.2

###Codigo #2:2_Calculo_PNTs_Exemplo_RMS.R

1. Instalar e abrir todos os pacotes necessários para o cálculo. 
   O comando setwd() permite definir um diretório para salvar os seus arquivos

2. Importar os dados das estações TMA disponíveis em https://mobilidados.org.br/database
   ATENÇÃO: É necessário que os shapes com os dados censitários e os dados das estações TMA estejam na mesma projeção.
   Utilize o código (st_crs(TMA_stations) ==  st_crs(Setores)) para conferir. Caso a resposta seja FALSE, reprojetar os shapes com o código st_transform(). O código ESPG da projecao varia para cada cidade/RM brasileira:
   - Belo Horizonte, Distrito Federal, Rio De Janeiro e Sao Paulo 31983
   - Recife 31985
   - Belem 31982
   - Fortaleza 31984
   
3. Criar o buffer de 1km ao redor das estações TMA e recortar os setores censitarios através do buffer criado

4. Calcular os dados totais de cada variavel para a RM/Cidade e os dados dentro da area do buffer das estações

5. Realizar calculo final dos indicadores de PNT com as variáveis criadas nos passos anteriores.
